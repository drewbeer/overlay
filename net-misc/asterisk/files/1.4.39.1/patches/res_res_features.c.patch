--- asterisk-1.4.39.1/res/res_features.c	2010-11-04 14:28:12.000000000 -0700
+++ asterisk-1.4.39.1-vici/res/res_features.c	2011-02-08 18:16:22.000000000 -0800
@@ -258,6 +258,7 @@ static void check_goto_on_transfer(struc
 	xferchan->_state = AST_STATE_UP;
 	ast_clear_flag(xferchan, AST_FLAGS_ALL);	
 	xferchan->_softhangup = 0;
+	ast_channel_clear_softhangup(xferchan, AST_SOFTHANGUP_ALL);
 	if ((f = ast_read(xferchan))) {
 		ast_frfree(f);
 		f = NULL;
